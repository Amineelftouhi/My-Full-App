name: CI - .NET + Angular App

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  backend:
    name: Build & Test .NET Backend
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout code
        uses: actions/checkout@v3

      - name: âš™ï¸ Setup .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'

      - name: ğŸ›  Build API
        run: dotnet build MyApp.API

      - name: âœ… Run backend tests
        run: dotnet test MyApp.Tests

frontend:
  name: Install & Test Angular Frontend
  runs-on: ubuntu-latest

  steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v3

    - name: âš™ï¸ Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: ğŸ›  Install Angular CLI globally
      run: npm install -g @angular/cli

    - name: ğŸ“¦ Install frontend dependencies
      run: cd frontend && npm install

    - name: ğŸ§ª Run Angular tests
      run: cd frontend && ./node_modules/.bin/ng test --watch=false --browsers=ChromeHeadless
